<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão Papelaria</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .completed { text-decoration: line-through; color: green; }
        .pending { color: black; }
        .saldo-positive { color: green; }
        .saldo-negative { color: red; }
    </style>
</head>
<body>
    <img src="logo.jpeg" width="200px"  class="mx-auto d-block rounded-circle mt-5"  alt="Logo">
    <div class="container mt-5">
        <h1 class="text-center mb-5" style="color: rgb(0, 102, 255);">Studio Vieira Papelaria</h1>
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="tasks-tab" data-bs-toggle="tab" data-bs-target="#tasks" type="button" role="tab">Gestão de Serviços</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="movements-tab" data-bs-toggle="tab" data-bs-target="#movements" type="button" role="tab">Controle de Caixa</button>
            </li>
        </ul>
        <div class="tab-content" id="myTabContent">
            <!-- Aba 1: Gestão de Serviços -->
            <div class="tab-pane fade show active" id="tasks" role="tabpanel">
                <h3 class="mt-3">Adicionar Nova Tarefa</h3>
                <form id="taskForm">
                    <div class="mb-3">
                        <label for="cliente" class="form-label">Nome do Cliente</label>
                        <input type="text" class="form-control" id="cliente" required>
                    </div>
                    <div class="mb-3">
                        <label for="descricao" class="form-label">Descrição do Serviço</label>
                        <textarea class="form-control" id="descricao" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="valor" class="form-label">Valor (R$)</label>
                        <input type="number" step="0.01" class="form-control" id="valor" required>
                    </div>
                    <div class="mb-3">
                        <label for="prazo" class="form-label">Prazo de Entrega (YYYY-MM-DD)</label>
                        <input type="date" class="form-control" id="prazo" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar Tarefa</button>
                </form>
                <h3 class="mt-4">Lista de Tarefas</h3>
                <ul id="taskList" class="list-group"></ul>
            </div>
            <!-- Aba 2: Controle de Caixa -->
            <div class="tab-pane fade" id="movements" role="tabpanel">
                <h3 class="mt-3">Adicionar Movimentação</h3>
                <form id="movementForm">
                    <div class="mb-3">
                        <label for="motivo" class="form-label">Motivo</label>
                        <input type="text" class="form-control" id="motivo" required>
                    </div>
                    <div class="mb-3">
                        <label for="valorMov" class="form-label">Valor (R$)</label>
                        <input type="number" step="0.01" class="form-control" id="valorMov" required>
                    </div>
                    <div class="mb-3">
                        <label for="tipo" class="form-label">Tipo</label>
                        <select class="form-select" id="tipo" required>
                            <option value="entrada">Entrada</option>
                            <option value="saida">Saída</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar Movimentação</button>
                </form>
                <h3 class="mt-4">Lista de Movimentações</h3>
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>Motivo</th>
                            <th>Valor</th>
                            <th>Data</th>
                            <th>Tipo</th>
                        </tr>
                    </thead>
                    <tbody id="movementTable"></tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3"><strong>Saldo Total:</strong></td>
                            <td id="saldo" class="fw-bold"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Funções utilitárias para localStorage
        function getTasks() {
            return JSON.parse(localStorage.getItem('tasks') || '[]');
        }

        function saveTasks(tasks) {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        function getMovements() {
            return JSON.parse(localStorage.getItem('movements') || '[]');
        }

        function saveMovements(movements) {
            localStorage.setItem('movements', JSON.stringify(movements));
        }

        // Funções para Tarefas
        function loadTasks() {
            const tasks = getTasks();
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            tasks.forEach((task, index) => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                li.innerHTML = `
                    <div class="${task.concluida ? 'completed' : 'pending'}">
                        <strong>${task.cliente}</strong> - ${task.descricao} - R$ ${task.valor} - Prazo: ${task.prazo}
                    </div>
                    <input type="checkbox" ${task.concluida ? 'checked' : ''} onchange="toggleTask(${index}, this.checked)">
                `;
                taskList.appendChild(li);
            });
        }

        function toggleTask(index, checked) {
            const tasks = getTasks();
            tasks[index].concluida = checked ? 1 : 0;
            saveTasks(tasks);
            loadTasks();
        }

        document.getElementById('taskForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const tasks = getTasks();
            const newTask = {
                id: Date.now(), // Simula ID único
                cliente: document.getElementById('cliente').value,
                descricao: document.getElementById('descricao').value,
                valor: parseFloat(document.getElementById('valor').value),
                prazo: document.getElementById('prazo').value,
                concluida: 0
            };
            tasks.push(newTask);
            saveTasks(tasks);
            document.getElementById('taskForm').reset();
            loadTasks();
        });

        // Funções para Movimentações
        function loadMovements() {
            const movements = getMovements();
            const movementTable = document.getElementById('movementTable');
            movementTable.innerHTML = '';
            movements.forEach(mov => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${mov.motivo}</td>
                    <td>R$ ${mov.valor}</td>
                    <td>${mov.data_inclusao}</td>
                    <td>${mov.tipo}</td>
                `;
                movementTable.appendChild(tr);
            });
            // Calcular saldo
            const entradas = movements.filter(m => m.tipo === 'entrada').reduce((sum, m) => sum + m.valor, 0);
            const saidas = movements.filter(m => m.tipo === 'saida').reduce((sum, m) => sum + m.valor, 0);
            const saldo = entradas - saidas;
            const saldoEl = document.getElementById('saldo');
            saldoEl.textContent = `R$ ${saldo.toFixed(2)}`;
            saldoEl.className = saldo >= 0 ? 'saldo-positive' : 'saldo-negative';
        }

        document.getElementById('movementForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const movements = getMovements();
            const newMovement = {
                id: Date.now(), // Simula ID único
                motivo: document.getElementById('motivo').value,
                valor: parseFloat(document.getElementById('valorMov').value),
                data_inclusao: new Date().toISOString().split('T')[0] + ' ' + new Date().toTimeString().split(' ')[0], // Data atual
                tipo: document.getElementById('tipo').value
            };
            movements.push(newMovement);
            saveMovements(movements);
            document.getElementById('movementForm').reset();
            loadMovements();
        });

        // Carregar dados iniciais
        loadTasks();
        loadMovements();
    </script>
</body>
</html>